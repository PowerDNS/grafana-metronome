version: '2'
services:

  grafana:
    image: grafana/grafana
    volumes:
      - data:/var/lib/grafana
      # Uncomment these to override the logo and favicon in Grafana
      #- ./img/powerdns-logo.svg:/usr/share/grafana/public/img/grafana_icon.svg:ro
      #- ./img/powerdns-favicon.png:/usr/share/grafana/public/img/fav32.png:ro
    ports:
      - "13000:3000"
    environment:
      GF_USERS_DEFAULT_THEME: light
      #GF_INSTALL_PLUGINS: grafana-clock-panel,grafana-simple-json-datasource
    networks:
      - net

  graphiteapi:
    build: graphite-api/
    ports:
      - "18003:8000"
    volumes:
      - graphiteapi:/src/graphite
      - ./graphite-api/metronome:/usr/local/lib/python2.7/dist-packages/metronome
    networks:
      - net
    command: gunicorn -b 0.0.0.0:8000 -w 2 --threads 10 --timeout 60 --reload --log-level debug --access-logfile /dev/stdout graphite_api.app:app

volumes:
  data:
    driver: local
  graphiteapi:
    driver: local

networks:
  net:
